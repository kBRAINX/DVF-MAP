
<div class="app">
  <!-- Navbar -->
  <app-navbar></app-navbar>

  <!-- Main Content -->
  <main class="main-content">
    <router-outlet></router-outlet>
  </main>

  <!-- Sidebar et contrÃ´les (seulement si authentifiÃ© et sur la carte) -->
  <ng-container *ngIf="isAuthenticated$ | async">
    <!-- Sidebar Toggle Button -->
    <button
      class="sidebar-toggle"
      [class.open]="sidebarOpen"
      (click)="toggleSidebar()"
      aria-label="Toggle sidebar"
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="9" y1="9" x2="15" y2="9"></line>
        <line x1="9" y1="12" x2="15" y2="12"></line>
        <line x1="9" y1="15" x2="15" y2="15"></line>
      </svg>
    </button>

    <!-- Sidebar -->
    <aside class="sidebar" [class.open]="sidebarOpen">
      <div class="sidebar-content">
        <app-form></app-form>
      </div>
    </aside>

    <!-- Map Controls -->
    <div class="map-controls">
      <!-- Map Type Selector -->
      <div class="control-group">
        <label class="control-label">Type de carte</label>
        <div class="button-group">
          <button
            class="control-btn"
            [class.active]="mapType === 'street'"
            (click)="setMapType('street')"
            title="Vue rue"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9,22 9,12 15,12 15,22"></polyline>
            </svg>
            Rue
          </button>
          <button
            class="control-btn"
            [class.active]="mapType === 'satellite'"
            (click)="setMapType('satellite')"
            title="Vue satellite"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M8 12l2 2 4-4"></path>
            </svg>
            Satellite
          </button>
          <button
            class="control-btn"
            [class.active]="mapType === 'cadastre'"
            (click)="setMapType('cadastre')"
            title="Vue cadastre"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
              <polyline points="7.5,4.21 12,6.81 16.5,4.21"></polyline>
              <polyline points="7.5,19.79 7.5,14.6 3,12"></polyline>
              <polyline points="21,12 16.5,14.6 16.5,19.79"></polyline>
              <polyline points="3.27,6.96 12,12.01 20.73,6.96"></polyline>
              <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
            Cadastre
          </button>
        </div>
      </div>

      <!-- Center Map Button -->
      <button
        class="control-btn center-btn"
        (click)="centerMap()"
        title="Centrer la carte"
      >
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="22" y1="12" x2="18" y2="12"></line>
          <line x1="6" y1="12" x2="2" y2="12"></line>
          <line x1="12" y1="6" x2="12" y2="2"></line>
          <line x1="12" y1="22" x2="12" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Overlay pour fermer la sidebar sur mobile -->
    <div class="sidebar-overlay" [class.open]="sidebarOpen" (click)="toggleSidebar()"></div>
  </ng-container>
</div>
